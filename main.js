

var notes=[];
//                   notes 
//           n°  MIDI     Latin    fréquence(Hz)
notes.push(["01","A-1"  ,"La-2"     ,27.5       ,"&"]);
notes.push(["02","A#-1" ,"La#-2"    ,29.1353    ,"é"]);
notes.push(["03","B-1"  ,"Si-2"     ,30.8677    ,'"']);
notes.push(["04","C0"   ,"Do-1"     ,32.7032    ,"'"]);
notes.push(["05","C#0"  ,"Do-1#"    ,34.6479    ,"("]);
notes.push(["06","D0"   ,"Re-1"     ,36.7081    ,"-"]);
notes.push(["07","D#0"  ,"Re-1#"    ,38.8909    ,"è"]);
notes.push(["08","E0"   ,"Mi-1"     ,41.2035    ,"_"]);
notes.push(["09","F0"   ,"Fa-1"     ,43.6536    ,"ç"]);
notes.push(["10","F#0"  ,"Fa#-1"    ,46.2493    ,"à"]);
notes.push(["11","G0"   ,"Sol-1"    ,48.9995    ,")"]);
notes.push(["12","G#0"  ,"Sol#-1"   ,51.9130    ,"="]);
notes.push(["13","A0"   ,"La-1"     ,55         ,"a"]);
notes.push(["14","A#0"  ,"La#-1"    ,58.2705    ,"z"]);
notes.push(["15","B0"   ,"Si-1"     ,61.7354    ,"e"]);
notes.push(["16","C1"   ,"Do1"      ,65.4064    ,"r"]);
notes.push(["17","C#1"  ,"Do#1"     ,69.2957    ,"t"]);
notes.push(["18","D1"   ,"Re1"      ,73.4162    ,"y"]);
notes.push(["19","D#1"  ,"Re#1"     ,77.7817    ,"u"]);
notes.push(["20","E1"   ,"Mi1"      ,82.4069    ,"i"]);
notes.push(["21","F1"   ,"Fa1"      ,87.3071    ,"o"]);
notes.push(["22","F#1"  ,"Fa#1"     ,92.4986    ,"p"]);
notes.push(["23","G1"   ,"Sol1"     ,97.9989    ,"Dead"]);
notes.push(["24","G#1"  ,"Sol#1"    ,103.826    ,"$"]);
notes.push(["25","A1"   ,"La1"      ,110        ,"q"]);
notes.push(["26","A#1"  ,"La#1"     ,116.541    ,"s"]);
notes.push(["27","B1"   ,"Si1"      ,123.471    ,"d"]);
notes.push(["28","C2"   ,"Do2"      ,130.813    ,"f"]);
notes.push(["29","C#2"  ,"Do#2"     ,138.591    ,"g"]);
notes.push(["30","D2"   ,"Re2"      ,146.832    ,"h"]);
notes.push(["31","D#2"  ,"Re#2"     ,155.563    ,"j"]);
notes.push(["32","E2"   ,"Mi2"      ,164.814    ,"k"]);
notes.push(["33","F2"   ,"Fa2"      ,174.614    ,"l"]);
notes.push(["34","F#2"  ,"Fa#2"     ,184.997    ,"m"]);
notes.push(["35","G2"   ,"Sol2"     ,195.998    ,"ù"]);
notes.push(["36","G#2"  ,"Sol#2"    ,207.652    ,"*"]);
notes.push(["37","A2"   ,"La2"      ,220        ,"<"]); 
notes.push(["38","A#2"  ,"La#2"     ,233.082    ,"w"]);
notes.push(["39","B2"   ,"Si2"      ,246.942    ,"x"]);
notes.push(["40","C3"   ,"Do3"      ,261.626    ,"c"]);
notes.push(["41","C#3"  ,"Do#3"     ,277.183    ,"v"]);
notes.push(["42","D3"   ,"Re3"      ,293.665    ,"b"]);
notes.push(["43","D#3"  ,"Re#3"     ,311.127    ,"n"]);
notes.push(["44","E3"   ,"Mi3"      ,329.628    ,","]);
notes.push(["45","F3"   ,"Fa3"      ,349.228    ,";"]);
notes.push(["46","F#3"  ,"Fa#3"     ,369.994    ,":"]);
notes.push(["47","G3"   ,"Sol3"     ,391.995    ,"!"]);
notes.push(["48","G#3"  ,"Sol#3"    ,415.305    ,"1"]);
notes.push(["49","A3"   ,"La3"      ,440        ,"2"]);
notes.push(["50","A#3"  ,"La#3"     ,466.164    ,"3"]);
notes.push(["51","B3"   ,"Si3"      ,493.883    ,"4"]);
notes.push(["52","C4"   ,"Do4"      ,523.251    ,"5"]);
notes.push(["53","C#4"  ,"Do#4"     ,554.365    ,"6"]);
notes.push(["54","D4"   ,"Re4"      ,587.33     ,"7"]);
notes.push(["55","D#4"  ,"Re#4"     ,622.254    ,"8"]);
notes.push(["56","E4"   ,"Mi4"      ,659.255    ,"9"]);
notes.push(["57","F4"   ,"Fa4"      ,698.456    ,"0"]);
notes.push(["58","F#4"  ,"Fa#4"     ,739.989    ,"A"]);
notes.push(["59","G4"   ,"Sol4"     ,783.991    ,"Z"]);
notes.push(["60","G#4"  ,"Sol#4"    ,830.609    ,"E"]);
notes.push(["61","A4"   ,"La4"      ,880        ,"R"]);
notes.push(["62","A#4"  ,"La#4"     ,932.328    ,"T"]);
notes.push(["63","B4"   ,"Si4"      ,987.767    ,"Y"]);
notes.push(["64","C5"   ,"Do5"      ,1046.5     ,"U"]);
notes.push(["65","C#5"  ,"Do#5"     ,1108.73    ,"I"]);
notes.push(["66","D5"   ,"Re5"      ,1174.66    ,"O"]);
notes.push(["67","D#5"  ,"Re#5"     ,1244.51    ,"P"]);
notes.push(["68","E5"   ,"Mi5"      ,1318.51    ,"Q"]);
notes.push(["69","F5"   ,"Fa5"      ,1396.91    ,"S"]);
notes.push(["70","F#5"  ,"Fa#5"     ,1479.98    ,"D"]);
notes.push(["71","G5"   ,"Sol5"     ,1567.98    ,"F"]);
notes.push(["72","G#5"  ,"Sol#5"    ,1661.22    ,"G"]);
notes.push(["73","A5"   ,"La5"      ,1760       ,"H"]);
notes.push(["74","A#5"  ,"La#5"     ,1864.66    ,"J"]);
notes.push(["75","B5"   ,"Si5"      ,1975.53    ,"K"]);
notes.push(["76","C6"   ,"Do6"      ,2093       ,"L"]);
notes.push(["77","C#6"  ,"Do#6"     ,2217.46    ,"M"]);
notes.push(["78","D6"   ,"Re6"      ,2349.32    ,"W"]);
notes.push(["79","D#6"  ,"Re#6"     ,2489.02    ,"X"]);
notes.push(["80","E6"   ,"Mi6"      ,2637.02    ,"C"]);
notes.push(["81","F6"   ,"Fa6"      ,2793.83    ,"V"]);
notes.push(["82","F#6"  ,"Fa#6"     ,2959.96    ,"B"]);
notes.push(["83","G6"   ,"Sol6"     ,3135.96    ,"N"]);
notes.push(["84","G#6"  ,"Sol#6"    ,3322.44    ,"?"]);
notes.push(["85","A6"   ,"La6"      ,3520       ,"."]);
notes.push(["86","A#6"  ,"La#6"     ,3729.31    ,"/"]);
notes.push(["87","B6"   ,"Si6"      ,3951.07    ,"§"]);
notes.push(["88","C7"   ,"Do7"      ,4186.01    ,"%"]);

for(x=1;x<=88;x++){
    var b=document.getElementById(""+x);
    var h=document.createElement("h4");
    h.innerHTML=notes[x-1][2];
    var hh=document.createElement("h3");
    hh.innerHTML=notes[x-1][1];
    var p=document.createElement("p");
    p.innerHTML=notes[x-1][4];
    b.appendChild(h);
    b.appendChild(hh);
    b.appendChild(p);
}


// crée un contexteaudio
var contexteAudio = new (window.AudioContext || window.webkitAudioContext)();


function suiteNote(oscillator){
    oscillator.stop();
}

function note(num){
    di=num-1
    n=notes[di]
    var oscillator = contexteAudio.createOscillator();
    oscillator.connect(contexteAudio.destination);
    oscillator.type = 'square';
    oscillator.frequency.value = n[3]; // valeur en hertz
    oscillator.start();
    setTimeout(suiteNote, 50, args=(oscillator)); //Attendez 1 secondes avant de continuer dans la fonction suivante
}

var isshift=false;

document.addEventListener('keydown', (event) => {
    const nomTouche = event.key;
    if(nomTouche=="Shift"){
    isshift=true;
    }
    else{
        if(isshift){
            nomTouche.toUpperCase();
            isshift=false;
        }
        nn=1
        for(n of notes){
            if(n[4]==nomTouche){
                note(nn);
            }
            nn+=1;
        }
    }
},false);

function rien(){
}

function readSheet(text){
	var nts=text.split("\n");
	var m=nts[0];
	var nb=0;
	if(m=="0" || m==0){ //le numero de la touche
	    for(n of nts){
		    if(nb>0 && n!=""){
			    setTimeout(note, 100, args=(parseInt(n)));
			}
			if(n==""){
				setTimeout(rien,100);
			}
			nb+=1
		}
	}
	if(m=="1" || m==1){ //le nom midi de la touche
	    for(n of nts){
		    if(nb>0){
			    for(t of notes){
				    if(n==t[1]){
			            setTimeout(note, 100, args=(notes.indexOf(t)+1));
			        }
			    }
			}
			if(n==""){
				setTimeout(rien,100);
			}
			nb+=1
		}
	}
	if(m=="2" || m==2){ //le nom latin de la touche
	    for(n of nts){
		    if(nb>0){
			    for(t of notes){
				    if(t[2]==n){
			            setTimeout(note, 100, args=(notes.indexOf(t)+1));
			        }
			    }
			}
			if(n==""){
				setTimeout(rien,100);
			}
			nb+=1
		}
	}
	if(m=="3" || m==3){ //le key event de la touche
	    for(n of nts){
		    if(nb>0){
			    for(t of notes){
				    if(t[4]==n){
			            setTimeout(note, 100, args=(notes.indexOf(t)+1));
			        }
			    }
			}
			if(n==""){
				setTimeout(rien,100);
			}
			nb+=1
		}
	}
}

function readFile() {
         var file = document.querySelector('input[type=file]').files[0];
         var reader = new FileReader()
         if (true) {
            reader.onload = function (event) {
                readSheet(event.target.result);
            }
         }
         reader.readAsText(file);
}


